# basic server setting
spring.application.name=AOD
spring.docker.compose.enabled=false
server.port=8080

# Tomcat Thread Pool Settings
server.tomcat.threads.max=200
server.tomcat.threads.min-spare=10
server.tomcat.max-connections=10000
server.tomcat.accept-count=100
server.tomcat.connection-timeout=20000

spring.datasource.url=jdbc:postgresql://localhost:5432/postgres
spring.datasource.username=postgres
spring.datasource.password=7292

# HikariCP Connection Pool Settings
spring.datasource.hikari.maximum-pool-size=20
spring.datasource.hikari.minimum-idle=5
spring.datasource.hikari.connection-timeout=30000
spring.datasource.hikari.idle-timeout=600000
spring.datasource.hikari.max-lifetime=1800000
spring.datasource.hikari.leak-detection-threshold=60000

# jpa setting
spring.jpa.properties.hibernate.format_sql=true
spring.jpa.hibernate.ddl-auto=none

# ===== ğŸš€ ë°°ì¹˜ ì²˜ë¦¬ ì„±ëŠ¥ ìµœì í™” =====
# Hibernate Batch Insert/Update (Nê°œë¥¼ í•œë²ˆì— ì²˜ë¦¬)
spring.jpa.properties.hibernate.jdbc.batch_size=50
spring.jpa.properties.hibernate.order_inserts=true
spring.jpa.properties.hibernate.order_updates=true
spring.jpa.properties.hibernate.jdbc.batch_versioned_data=true

# Batch Fetch (N+1 ë¬¸ì œ í•´ê²°)
spring.jpa.properties.hibernate.default_batch_fetch_size=50

# Statement Caching (PreparedStatement ì¬ì‚¬ìš©)
spring.jpa.properties.hibernate.jdbc.use_streams_for_binary=true
spring.jpa.properties.hibernate.query.plan_cache_max_size=2048
spring.jpa.properties.hibernate.query.plan_parameter_metadata_max_size=128

# Logging
logging.level.root=INFO
logging.level.com.example.AOD=DEBUG
logging.level.com.example.AOD.service.similarity=INFO

# ===== Actuator & Prometheus ?? =====
management.endpoints.web.exposure.include=health,metrics,prometheus,info,threaddump
management.endpoint.health.show-details=always
management.endpoint.health.probes.enabled=true

# Prometheus ??? ???
management.metrics.export.prometheus.enabled=true
management.metrics.distribution.percentiles-histogram.http.server.requests=true

# ?????? ??
management.info.env.enabled=true
info.app.name=AOD Crawler
info.app.description=Content Aggregation & Recommendation System
info.app.version=1.0.0

# ??? ??
management.metrics.tags.application=${spring.application.name}
management.metrics.tags.environment=${spring.profiles.active:default}

# JVM ???
management.metrics.enable.jvm=true
management.metrics.enable.process=true
management.metrics.enable.system=true
management.metrics.enable.tomcat=true
management.metrics.enable.logback=true
management.metrics.enable.executor=true

#TMDB API
tmdb.api.key=2ce2aa190c966e5d87d537117d450cec

# Steam API
steam.api.key=${STEAM_API_KEY:FFDC108C0841A3A4177B6EE9EE321916}

# OpenAI API
openai.api.key=${OPENAI_API_KEY}
openai.api.url=https://api.openai.com/v1/chat/completions
# ?? ??
recommendation.traditional.max-items-per-category=10
recommendation.llm.max-tokens=1500
recommendation.llm.temperature=0.7
recommendation.llm.model=gpt-3.5-turbo

# ?? ??
spring.cache.type=simple
spring.cache.cache-names=traditional-recommendations,llm-recommendations

# ===== Sentry ì—ëŸ¬ ì¶”ì  =====
# ìƒˆë¡œìš´ í”„ë¡œì íŠ¸ DSN (java-spring-boot)
sentry.dsn=${SENTRY_DSN:https://89985b44a757af035a6db5b3680ce954@o4510538930192384.ingest.us.sentry.io/4510538931634176}
sentry.environment=${spring.profiles.active:local}
sentry.traces-sample-rate=0.1
sentry.logging.minimum-event-level=error
sentry.logging.minimum-breadcrumb-level=info

# ì‚¬ìš©ì ì •ë³´ ìˆ˜ì§‘ (IP, Headers ë“±)
sentry.send-default-pii=true

sentry.enable-tracing=true

# Sentry íƒœê·¸ (í•„í„°ë§ ë° ê²€ìƒ‰ìš©)
sentry.tags.application=${spring.application.name}
sentry.tags.version=${info.app.version:1.0.0}

# ì œì™¸í•  ì˜ˆì™¸ (ë¬´ì‹œ)
sentry.ignored-exceptions-for-type=org.springframework.security.access.AccessDeniedException,org.springframework.web.HttpRequestMethodNotSupportedException
